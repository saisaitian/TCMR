# Generated by roxytest: Do not edit by hand!

context("File R/deg_caller.R: @testexamples")

test_that("Function deg_caller() @ L36", {
  
  data <- load_example_dataset()
  
  # Get a subset of expression dataset
  ix <- c(1, 2, 61, 62)
  expr <- data$expr[, ix]
  group <- data$pdata$perturbagen[ix]
  
  # Run DEG analysis
  report <- deg_caller(expr, group = group, ref_group = group[3])
  head(report)
  
  # Run batch DEG analysis
  reports <- deg_batch_caller(expr, groups = group, ref_group = group[3])
  head(reports)
  
  identical(report, reports[[1]])
  expect_is(report, "data.table")
  expect_is(reports, "list")
  expect_identical(report, reports[[1]])
})

